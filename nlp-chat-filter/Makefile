# ========== –û–ë–£–ß–ï–ù–ò–ï ==========
train:
	python -m src.models.train

# ========== –ò–ù–§–ï–†–ï–ù–° –í –ö–û–ù–°–û–õ–ò ==========
infer:
	python -c "from src.models.infer import load_router; \
infer = load_router(); \
sample = ['–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–ø–ª–∞—Ç–∞', '—Ö–æ—á—É –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –≥–æ–¥', '—á—Ç–æ–æ–æ–æ?']; \
[print(f'[{p.label_id} | {p.label_name}] ‚Üí {t}') for p, t in zip(infer(sample), sample)]"

# ========== –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–´–ô –ò–ù–§–ï–†–ï–ù–° ==========
test_infer:
	python -m src.serving.cli

# ========== FASTAPI ==========
api:
	uvicorn src.serving.api_fastapi:app --reload

# ========== –£–î–ê–õ–ï–ù–ò–ï –ê–†–¢–ï–§–ê–ö–¢–û–í –ò –ì–†–ê–§–ò–ö–û–í ==========
clean:
	rm -f models/artifacts/*.joblib
	rm -f models/artifacts/*.json
	rm -f reports/figures/*.png

# ========== –ü–û–ú–û–©–¨ ==========
help:
	@echo "üß† –ö–æ–º–∞–Ω–¥—ã:"
	@echo "  make train       ‚Äî –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤"
	@echo "  make infer       ‚Äî –±—ã—Å—Ç—Ä—ã–π batch-–∏–Ω—Ñ–µ—Ä–µ–Ω—Å (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã)"
	@echo "  make test_infer  ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Ñ–µ—Ä–µ–Ω—Å (–≤–≤–æ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å—Ç—Ä–æ–∫–æ–π)"
	@echo "  make api         ‚Äî –∑–∞–ø—É—Å–∫ FastAPI —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ http://127.0.0.1:8000"
	@echo "  make clean       ‚Äî —É–¥–∞–ª–∏—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∏ –≥—Ä–∞—Ñ–∏–∫–∏"
